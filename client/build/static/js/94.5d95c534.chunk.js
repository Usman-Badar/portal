(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[94],{633:function(e,t,n){"use strict";n.r(t);var a=n(5),o=n(1),i=n(3),c=n(86),s=(n(85),n(24)),r=n(9),d=n(11),l=n(97),u=n(81),p=n.n(u),f=n(149),m=function(){var e=document.getElementById("specifications_table_body").childNodes,t=document.createElement("tr");t.id="specification_row_"+parseInt(e.length+1);var n=document.createElement("td");n.id="specification_serial_number_"+parseInt(e.length+1);var a=document.createElement("td");a.contentEditable=!0,a.addEventListener("input",b),a.id="specification_description_"+parseInt(e.length+1);var o=document.createElement("td");o.contentEditable=!0,o.addEventListener("input",b),o.id="specification_quantity_"+parseInt(e.length+1);var i=document.createElement("td");i.contentEditable=!0,i.addEventListener("input",b),i.id="specification_unit_"+parseInt(e.length+1);var c=document.createElement("td");c.contentEditable=!0,c.addEventListener("input",b),c.id="specification_est_cost_"+parseInt(e.length+1);var s=document.createElement("td");s.id="specification_total_cost_"+parseInt(e.length+1),t.appendChild(n),t.appendChild(a),t.appendChild(o),t.appendChild(i),t.appendChild(c),t.appendChild(s),document.getElementById("specifications_table_body").appendChild(t)},h=function(){var e=document.getElementById("specifications_table_footer").childNodes,t=Array.from(e).filter((function(e){return e.id.includes("additional_labels_")})),n=document.getElementById("final_total"),a=document.createElement("tr");a.id="additional_labels_"+parseInt(t.length+1);var o=document.createElement("td");o.className="border-0";var i=document.createElement("td");i.className="border-0";var c=document.createElement("td");c.className="border-0";var s=document.createElement("td");s.className="border-0";var r=document.createElement("td");r.contentEditable=!0,r.addEventListener("input",_),r.className="text-center",r.id="additional_label_"+parseInt(t.length+1);var d=document.createElement("td");d.contentEditable=!0,d.addEventListener("input",_),d.id="additional_value_"+parseInt(t.length+1),a.appendChild(o),a.appendChild(i),a.appendChild(c),a.appendChild(s),a.appendChild(r),a.appendChild(d),document.getElementById("specifications_table_footer").insertBefore(a,n)},b=function(e){var t=e.target.id.split("_").pop(),n="specification_row_"+t,a=document.getElementById(n).childNodes,o=a[0],i=a[1],c=a[2],s=a[3],r=a[4],d=a[5];v(e,c,r,d,o,i,s,t)},_=function(e){var t="additional_labels_"+e.target.id.split("_").pop(),n=document.getElementById(t).childNodes[5];g(e,n)},g=function(e,t){if(e.target.id.includes("additional_value_")){var n=document.getElementById("total_calculated_amount").textContent,a=parseInt(""==t.textContent?0:t.textContent);if(isNaN(a))return t.style.outline="1px solid red",!1;t.style.outline="none",n=parseFloat(n)+a,j()}},v=function(e,t,n,a,o,i,c,s){if(e.target.id.includes("specification_quantity")||e.target.id.includes("specification_est_cost"))if(""==t.textContent&&""==n.textContent)a.textContent="";else{var r=parseInt(""==t.textContent?0:t.textContent),d=parseFloat(""==n.textContent?0:n.textContent);if(isNaN(r))return t.style.outline="1px solid red",o.textContent="",!1;if(t.style.outline="none",isNaN(d))return n.style.outline="1px solid red",o.textContent="",!1;n.style.outline="none",a.textContent=r*d,C(o,i,t,n,c,s),j()}},j=function(){for(var e=document.getElementById("specifications_table_body").childNodes,t=Object.keys(e).map((function(t){return[e[t]]})),n=0,a=0;a<t.length;a++){var o=t[a][0].childNodes[5];""!==o.textContent&&(n+=parseInt(o.textContent))}return document.getElementById("sub_total_calculated_amount").textContent=n,O(),n},O=function(){for(var e=document.getElementById("sub_total_calculated_amount").textContent,t=document.getElementById("specifications_table_footer").childNodes,n=Array.from(t).filter((function(e){return e.id.includes("additional_labels_")})),a=Object.keys(n).map((function(e){return[n[e]]})),o=0,i=0;i<a.length;i++){var c=a[i][0].childNodes[5];""!==c.textContent&&(o+=parseInt(c.textContent))}return document.getElementById("total_calculated_amount").textContent=parseFloat(e)+parseFloat(o),parseFloat(e)+parseFloat(o)},C=function(e,t,n,a,o,i){""!==t.textContent&&""!==n.textContent&&""!==o.textContent&&""!==a.textContent?e.textContent=i:e.textContent=""},y=n(0),I=Object(o.lazy)((function(){return Promise.all([n.e(100),n.e(38)]).then(n.bind(null,656))}));t.default=function(){var e=Object(i.g)(),t=Object(o.useState)(!1),n=Object(a.a)(t,2),u=n[0],g=n[1],v=Object(o.useState)(!1),C=Object(a.a)(v,2),x=C[0],E=C[1],S=Object(o.useState)([]),N=Object(a.a)(S,2),q=N[0],B=N[1],k=Object(o.useState)([]),D=Object(a.a)(k,2),R=D[0],w=D[1],P=Object(o.useState)([]),A=Object(a.a)(P,2),T=A[0],F=A[1],L=Object(o.useState)([]),J=Object(a.a)(L,2),V=J[0],M=J[1],z=Object(o.useState)([]),G=Object(a.a)(z,2),H=G[0],U=G[1],W=Object(o.useState)(),Y=Object(a.a)(W,2),K=Y[0],Q=Y[1],X=Object(o.useState)(),Z=Object(a.a)(X,2),$=Z[0],ee=Z[1],te=Object(o.useState)(),ne=Object(a.a)(te,2),ae=ne[0],oe=ne[1],ie=Object(o.useState)(),ce=Object(a.a)(ie,2),se=ce[0],re=ce[1],de=Object(o.useState)(),le=Object(a.a)(de,2),ue=le[0],pe=le[1],fe=Object(o.useState)(),me=Object(a.a)(fe,2),he=me[0],be=me[1],_e=Object(o.useState)(),ge=Object(a.a)(_e,2),ve=ge[0],je=ge[1],Oe=Object(o.useState)([]),Ce=Object(a.a)(Oe,2),ye=Ce[0],Ie=Ce[1],xe=Object(o.useState)(),Ee=Object(a.a)(xe,2),Se=Ee[0],Ne=Ee[1],qe=Object(o.useState)(),Be=Object(a.a)(qe,2),ke=Be[0],De=Be[1],Re=Object(o.useState)(),we=Object(a.a)(Re,2),Pe=we[0],Ae=we[1],Te=Object(o.useState)(),Fe=Object(a.a)(Te,2),Le=Fe[0],Je=Fe[1],Ve=Object(o.useState)([]),Me=Object(a.a)(Ve,2),ze=Me[0],Ge=Me[1];return Object(o.useEffect)((function(){!function(e){d.a.get("/getallcompanies").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(F),function(e){d.a.get("/getalllocations").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(M)}),[]),Object(o.useEffect)((function(){$&&!he&&function(e,t){d.a.post("/purchase/requisition/load/requests_with_specifications",{emp_id:sessionStorage.getItem("EmpID")}).then((function(n){e(n.data[0]),t(n.data[1])})).catch((function(e){console.log(e)}))}(be,Ie)}),[$]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(o.Suspense,{fallback:Object(y.jsx)("div",{children:"Please Wait..."}),children:Object(y.jsx)(I,{Companies:T,Locations:V,Bills:q,ShowBillModal:u,SubmitConfirmation:x,Requests:ue,history:e,RequestDetails:Se,Specifications:H,AttachedBills:R,Vendors:ae,PRAttachment:$,PRList:he,PRSPec:ye,PR:ve,AdditionalRows:ke,PRequestDetails:Le,PRSpecifications:ze,SubOrdinands:Pe,Data:K,Vendor:se,SubTotalCostCalculation:j,TotalCostCalculation:O,loadSubOrdinands:function(){return function(e){d.a.post("/purchase/order/load/subordinates",{emp_id:sessionStorage.getItem("EmpID")}).then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(Ae)},onFooterContentInput:_,addAdditionalRow:h,attachPR:function(e){je(e),ee(!1)},setPRAttachment:ee,selectVendor:function(e,t){document.getElementById("vendor_id").value=t,re(e),oe()},searchVendor:function(e){return function(e,t,n){if(n(),""===e.target.value)return t(),!1;d.a.post("/inventory/venders/search",{key:e.target.value}).then((function(e){t(e.data)})).catch((function(e){console.log(e)}))}(e,oe,re)},addRow:m,openRequestDetails:function(e){return function(e,t,n,a,o,i,c){d.a.post("/purchase/order/details",{po_id:e,viewed:!0}).then((function(e){t(e.data[0][1][0]),n(e.data[0][2]),a(e.data[0][3]),o(e.data[0][4]),e.data[1].length>0&&(i(e.data[1][0][0]),c(e.data[1][1]))})).catch((function(e){console.log(e)}))}(e,Ne,U,w,De,Je,Ge)},POSubmittion:function(t){return function(e,t,n,a,o,i,c){e.preventDefault();var s=new FormData;p()("fieldset").prop("disabled",!0),s.append("specifications",JSON.stringify(c)),s.append("data",JSON.stringify(a)),s.append("note",e.target.notes.value),s.append("submitted_to",e.target.request_to.value),s.append("pr_id",o),s.append("vendor_id",i),s.append("requested_by",sessionStorage.getItem("EmpID")),n.forEach((function(e){s.append("Attachments",e.file)})),d.a.post("/purchase/order/submission",s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){if("success"===e.data){var n=p()("input#draft_id").val();if(void 0!==n||""!==n||null!==n){var a=JSON.parse(localStorage.getItem("poDrafts")).filter((function(e){return e.draft_id!=n}));0===a.length?localStorage.removeItem("poDrafts"):localStorage.setItem("poDrafts",JSON.stringify(a))}l.a.emit("new_purchase_order_found"),setTimeout((function(){p()("fieldset").prop("disabled",!1),t.replace("/purchase/order/requests")}),2e3),f.a.alert("Purchase Order Has Been Generated").dismissIn(2e3)}})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,e,q,K,ve,se,H)},SubmitPO:function(e){return function(e,t,n,a){e.preventDefault();for(var o=document.getElementById("specifications_table_body").childNodes,i=Object.keys(o).map((function(e){return[o[e]]})),c=[],d=!0,l=function(e){var t=!0,n={},a=i[e][0].childNodes,o=Object.keys(a).map((function(e){return[a[e]]}));""===i[e][0].childNodes[1].textContent&&""===i[e][0].childNodes[2].textContent&&""===i[e][0].childNodes[3].textContent||""===i[e][0].childNodes[0].textContent&&(d=!1,f.a.alert("There is an incomplete value in the specifications list.").dismissIn(2e3));for(var l=0;l<o.length;l++){var u=o[l][0].id.split("_");u.pop(),n=Object(r.a)(Object(r.a)({},n),{},Object(s.a)({},u.join("_"),o[l][0].textContent))}for(var p=Object.keys(n).map((function(e){return[n[e]]})),m=0;m<p.length;m++)""===p[m][0]&&(t=!1);t&&c.push(n)},u=0;u<i.length;u++)l(u);0===c.length&&(d=!1,f.a.alert("No Specification Found.").dismissIn(2e3));for(var p=document.getElementById("specifications_table_footer").childNodes,m=Array.from(p).filter((function(e){return e.id.includes("additional_labels_")})),h=Object.keys(m).map((function(e){return[m[e]]})),b=[],_=function(e){var t=!0,n={},a=h[e][0].childNodes,o=Object.keys(a).map((function(e){return[a[e]]}));""===h[e][0].childNodes[4].textContent&&""===h[e][0].childNodes[5].textContent||(""===h[e][0].childNodes[4].textContent&&(d=!1,f.a.alert("There is an incomplete value in the additional specifications list.").dismissIn(2e3)),""===h[e][0].childNodes[5].textContent&&(d=!1,f.a.alert("There is an incomplete value in the additional specifications list.").dismissIn(2e3)));for(var i=0;i<o.length;i++)if(""!==o[i][0].id){var c=o[i][0].id.split("_");c.pop(),n=Object(r.a)(Object(r.a)({},n),{},Object(s.a)({},c.join("_"),o[i][0].textContent))}for(var l=Object.keys(n).map((function(e){return[n[e]]})),u=0;u<l.length;u++)t=""!==l[u][0];t&&b.push(n)},g=0;g<h.length;g++)_(g);d&&(t({company_code:e.target.company_code.value,location_code:e.target.location_code.value,invoice_no:e.target.invoice_no.value,new_purchase_checkbox:e.target.new_purchase.checked,repair_checkbox:e.target.repair.checked,replace_recycle_checkbox:e.target.replace_recycle.checked,invoice_attached_checkbox:e.target.invoice_attached.checked,sub_total_calculated_amount:j(),total_calculated_amount:O(),additional_specifications:b}),n(!0),a(c))}(e,Q,E,U)},setSubmitConfirmation:E,onAttachBills:function(e){return function(e,t){var n=new FileReader;n.onload=function(){if(2===n.readyState){for(var a=[],o=0;o<e.target.files.length;o++)a.push({file:e.target.files[o],name:e.target.files[o].name,extension:e.target.files[o].type});t(a)}},e.target.files[0]&&n.readAsDataURL(e.target.files[0])}(e,B)},setShowBillModal:g,onContentInput:b,loadRequests:function(){return function(e){d.a.post("/purchase/order/load/requests",{emp_id:sessionStorage.getItem("EmpID")}).then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(pe)},CancelRequisition:function(t,n){return function(e,t,n){e.preventDefault();var a=e.target.reason.value;p()("fieldset").prop("disabled",!0),d.a.post("/purchase/requisition/cancellation",{emp_id:sessionStorage.getItem("EmpID"),reason:a,pr_id:t}).then((function(e){"success"===e.data&&(setTimeout((function(){n.push("/purchase/requisition/requests")}),1500),p()("#error_alert_cancelation").removeClass("d-none").text("Your application has been canceled."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,e)},ApproveRequisition:function(t,n,a){return function(e,t,n,a){e.preventDefault();var o=e.target.reason.value,i=e.target.submit_to.value;p()("fieldset").prop("disabled",!0),d.a.post("/purchase/order/approval",{emp_id:sessionStorage.getItem("EmpID"),reason:o,submit_to:i,po_id:t,requested_by:n}).then((function(e){"success"===e.data&&(setTimeout((function(){a.push("/purchase/order/requests")}),1500),p()("#error_alert_approval").removeClass("d-none").text("The application has been approved."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,a,e)},RejectRequisition:function(t,n,a,o){return function(e,t,n,a,o){e.preventDefault();var i=e.target.reason.value;p()("fieldset").prop("disabled",!0),d.a.post("/purchase/order/reject",{emp_id:sessionStorage.getItem("EmpID"),remarks:i,po_id:t,requested_by:n,specifications:JSON.stringify(a),department:"accounts"}).then((function(e){"success"===e.data&&(setTimeout((function(){o.push("/purchase/order/requests")}),1500),p()("#error_alert_rejection").removeClass("d-none").text("The application has been rejected."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,a,o,e)}})}),Object(y.jsx)(c.a,{})]})}}}]);