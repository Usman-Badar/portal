(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[87],{619:function(e,t,n){"use strict";n.r(t);var o=n(4),a=n(1),i=n(3),s=n(83),c=(n(82),n(24)),r=n(9),u=n(11),l=n(95),d=n(80),p=n.n(d),f=function(e){var t=e.target.id.split("_").pop(),n="specification_row_"+t,o=document.getElementById(n).childNodes,a=o[0],i=o[1],s=o[2],c=o[3],r=o[4];h(e,s,c,r,a,i,t)},h=function(e,t,n,o,a,i,s){if(e.target.id.includes("specification_quantity")||e.target.id.includes("specification_est_cost"))if(""==t.textContent&&""==n.textContent)o.textContent="";else{var c=parseInt(""==t.textContent?0:t.textContent),r=parseFloat(""==n.textContent?0:n.textContent);if(isNaN(c))return t.style.outline="1px solid red",a.textContent="",!1;if(t.style.outline="none",isNaN(r))return n.style.outline="1px solid red",a.textContent="",!1;n.style.outline="none",o.textContent=c*r,g(a,i,t,n,s),b()}},b=function(){for(var e=document.getElementById("specifications_table_body").childNodes,t=Object.keys(e).map((function(t){return[e[t]]})),n=0,o=0;o<t.length;o++){var a=t[o][0].childNodes[4];""!==a.textContent&&(n+=parseInt(a.textContent))}return document.getElementById("total_calculated_amount").textContent=n,n},g=function(e,t,n,o,a){""!==t.textContent&&""!==n.textContent&&""!==o.textContent?e.textContent=a:e.textContent=""},m=n(0),_=Object(a.lazy)((function(){return n.e(37).then(n.bind(null,639))}));t.default=function(){var e=Object(i.g)(),t=Object(a.useState)(!1),n=Object(o.a)(t,2),d=n[0],h=n[1],g=Object(a.useState)(!1),j=Object(o.a)(g,2),v=j[0],O=j[1],x=Object(a.useState)([]),C=Object(o.a)(x,2),y=C[0],q=C[1],S=Object(a.useState)([]),k=Object(o.a)(S,2),I=k[0],N=k[1],D=Object(a.useState)([]),R=Object(o.a)(D,2),E=R[0],w=R[1],T=Object(a.useState)([]),B=Object(o.a)(T,2),P=B[0],A=B[1],J=Object(a.useState)([]),Q=Object(o.a)(J,2),F=Q[0],H=Q[1],L=Object(a.useState)(),M=Object(o.a)(L,2),z=M[0],G=M[1],U=Object(a.useState)(),W=Object(o.a)(U,2),Y=W[0],K=W[1],V=Object(a.useState)(),X=Object(o.a)(V,2),Z=X[0],$=X[1];return Object(a.useEffect)((function(){!function(e){u.a.get("/getallcompanies").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(w),function(e){u.a.get("/getalllocations").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(A)}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(a.Suspense,{fallback:Object(m.jsx)("div",{children:"Please Wait..."}),children:Object(m.jsx)(_,{Companies:E,Locations:P,Quotations:y,ShowQuotationModal:d,SubmitConfirmation:v,Requests:Y,history:e,RequestDetails:Z,Specifications:F,AttachedQuotations:I,openRequestDetails:function(e){return function(e,t,n,o){u.a.post("/purchase/requisition/details",{pr_id:e}).then((function(e){t(e.data[1][0]),n(e.data[2]),o(e.data[3])})).catch((function(e){console.log(e)}))}(e,$,H,N)},PRSubmittion:function(t){return function(e,t,n,o,a){e.preventDefault();for(var i=new FormData,s=document.getElementById("specifications_table_body").childNodes,d=Object.keys(s).map((function(e){return[s[e]]})),f=[],h=!0,b=function(e){var t=!0,o={},a=d[e][0].childNodes,i=Object.keys(a).map((function(e){return[a[e]]}));""===d[e][0].childNodes[1].textContent&&""===d[e][0].childNodes[2].textContent&&""===d[e][0].childNodes[3].textContent||""===d[e][0].childNodes[0].textContent&&(h=!1,n.dark("There is an incomplete value in the specifications list.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}));for(var s=0;s<i.length;s++){var u=i[s][0].id.split("_");u.pop(),o=Object(r.a)(Object(r.a)({},o),{},Object(c.a)({},u.join("_"),i[s][0].textContent))}for(var l=Object.keys(o).map((function(e){return[o[e]]})),p=0;p<l.length;p++)""===l[p][0]&&(t=!1);t&&f.push(o)},g=0;g<d.length;g++)b(g);h&&(p()("fieldset").prop("disabled",!0),i.append("specifications",JSON.stringify(f)),i.append("data",JSON.stringify(a)),i.append("note",e.target.notes.value),i.append("requested_by",sessionStorage.getItem("EmpID")),o.forEach((function(e){i.append("Attachments",e.file)})),u.a.post("/purchase/requisition/submittion&&submit_by=employee",i,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){"success"===e.data&&(l.a.emit("new_purchase_requisition_found"),setTimeout((function(){p()("fieldset").prop("disabled",!1),t.replace("/purchase/requisition/requests")}),2e3),n.dark("Purchase Requisition Has Been Generated",{position:"top-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)})))}(t,e,s.b,y,z)},SubmitPR:function(e){return function(e,t,n){e.preventDefault(),t({company_code:e.target.company_code.value,location_code:e.target.location_code.value,new_purchase_checkbox:e.target.new_purchase.checked,repair_replacement_checkbox:e.target.repair_replacement.checked,budgeted_checkbox:e.target.budgeted.checked,not_budgeted_checkbox:e.target.not_budgeted.checked,invoice_attached_checkbox:e.target.invoice_attached.checked,reason:e.target.reason.value,total_calculated_amount:b()}),n(!0)}(e,G,O)},setSubmitConfirmation:O,onAttachQuotations:function(e){return function(e,t){var n=new FileReader;n.onload=function(){if(2===n.readyState){for(var o=[],a=0;a<e.target.files.length;a++)o.push({file:e.target.files[a],name:e.target.files[a].name,extension:e.target.files[a].type});t(o)}},e.target.files[0]&&n.readAsDataURL(e.target.files[0])}(e,q)},setShowQuotationModal:h,onContentInput:f,loadRequests:function(){return function(e){u.a.post("/purchase/requisition/load/requests",{emp_id:sessionStorage.getItem("EmpID")}).then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(K)},CancelRequisition:function(t,n){return function(e,t,n){e.preventDefault();var o=e.target.reason.value;p()("fieldset").prop("disabled",!0),u.a.post("/purchase/requisition/cancellation",{emp_id:sessionStorage.getItem("EmpID"),reason:o,pr_id:t}).then((function(e){"success"===e.data&&(setTimeout((function(){n.push("/purchase/requisition/requests")}),1500),p()("#error_alert_cancelation").removeClass("d-none").text("Your application has been canceled."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,e)},ApproveRequisition:function(t,n,o,a){return function(e,t,n,o,a){e.preventDefault();var i=e.target.reason.value;p()("fieldset").prop("disabled",!0),u.a.post("/purchase/requisition/approval",{emp_id:sessionStorage.getItem("EmpID"),reason:i,pr_id:t,requested_by:n,submitted_to:o}).then((function(e){"success"===e.data&&(setTimeout((function(){a.push("/purchase/requisition/requests")}),1500),p()("#error_alert_approval").removeClass("d-none").text("The application has been approved."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,o,a,e)},RejectRequisition:function(t,n,o,a){return function(e,t,n,o,a){e.preventDefault();var i=e.target.reason.value;p()("fieldset").prop("disabled",!0),u.a.post("/purchase/requisition/reject",{emp_id:sessionStorage.getItem("EmpID"),remarks:i,pr_id:t,requested_by:n,specifications:JSON.stringify(o),department:"accounts"}).then((function(e){"success"===e.data&&(setTimeout((function(){a.push("/purchase/requisition/requests")}),1500),p()("#error_alert_rejection").removeClass("d-none").text("The application has been rejected."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,o,a,e)}})}),Object(m.jsx)(s.a,{})]})}}}]);