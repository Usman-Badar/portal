(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[95],{632:function(e,t,n){"use strict";n.r(t);var o=n(5),i=n(1),a=n(3),c=n(86),s=(n(85),n(24)),r=n(9),u=n(11),d=n(97),l=n(81),p=n.n(l),f=function(e){var t=e.target.id.split("_").pop(),n="specification_row_"+t,o=document.getElementById(n).childNodes,i=o[0],a=o[1],c=o[2],s=o[3],r=o[4];b(e,c,s,r,i,a,t)},h=function(e){var t=e.target.id.split("_").pop(),n="specification_row_"+t,o=document.getElementById(n).childNodes,i=o[0],a=o[1],c=o[2],s=o[3],r=o[4];b(e,c,s,r,i,a,t),document.getElementById(n).className="bg-success text-light"},b=function(e,t,n,o,i,a,c){if(e.target.id.includes("specification_quantity")||e.target.id.includes("specification_est_cost"))if(""==t.textContent&&""==n.textContent)o.textContent="";else{var s=parseInt(""==t.textContent?0:t.textContent),r=parseFloat(""==n.textContent?0:n.textContent);if(isNaN(s))return t.style.outline="1px solid red",i.textContent="",!1;if(t.style.outline="none",isNaN(r))return n.style.outline="1px solid red",i.textContent="",!1;n.style.outline="none",o.textContent=s*r,m(i,a,t,n,c),g()}},g=function(){for(var e=document.getElementById("specifications_table_body").childNodes,t=Object.keys(e).map((function(t){return[e[t]]})),n=0,o=0;o<t.length;o++){var i=t[o][0].childNodes[4];""!==i.textContent&&(n+=parseInt(i.textContent))}return document.getElementById("total_calculated_amount").textContent=n,n},m=function(e,t,n,o,i){""!==t.textContent&&""!==n.textContent&&""!==o.textContent?e.textContent=i:e.textContent=""},_=function(){var e=document.getElementById("specifications_table_body").childNodes,t=document.createElement("tr");t.id="specification_row_"+parseInt(e.length+1);var n=document.createElement("td");n.id="specification_serial_number_"+parseInt(e.length+1);var o=document.createElement("td");o.contentEditable=!0,o.addEventListener("input",f),o.id="specification_description_"+parseInt(e.length+1);var i=document.createElement("td");i.contentEditable=!0,i.addEventListener("input",f),i.id="specification_quantity_"+parseInt(e.length+1);var a=document.createElement("td");a.contentEditable=!0,a.addEventListener("input",f),a.id="specification_est_cost_"+parseInt(e.length+1);var c=document.createElement("td");c.id="specification_total_cost_"+parseInt(e.length+1),t.appendChild(n),t.appendChild(o),t.appendChild(i),t.appendChild(a),t.appendChild(c),document.getElementById("specifications_table_body").appendChild(t)},v=n(0),j=Object(i.lazy)((function(){return n.e(39).then(n.bind(null,655))}));t.default=function(){var e=Object(a.g)(),t=Object(i.useState)(!1),n=Object(o.a)(t,2),l=n[0],b=n[1],m=Object(i.useState)(!1),C=Object(o.a)(m,2),O=C[0],x=C[1],y=Object(i.useState)([]),q=Object(o.a)(y,2),E=q[0],I=q[1],S=Object(i.useState)([]),k=Object(o.a)(S,2),N=k[0],D=k[1],R=Object(i.useState)([]),w=Object(o.a)(R,2),B=w[0],T=w[1],P=Object(i.useState)([]),A=Object(o.a)(P,2),J=A[0],L=A[1],Q=Object(i.useState)([]),F=Object(o.a)(Q,2),H=F[0],M=F[1],z=Object(i.useState)(),G=Object(o.a)(z,2),U=G[0],W=G[1],Y=Object(i.useState)(),K=Object(o.a)(Y,2),V=K[0],X=K[1],Z=Object(i.useState)(),$=Object(o.a)(Z,2),ee=$[0],te=$[1];return Object(i.useEffect)((function(){!function(e){u.a.get("/getallcompanies").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(T),function(e){u.a.get("/getalllocations").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(L)}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(i.Suspense,{fallback:Object(v.jsx)("div",{children:"Please Wait..."}),children:Object(v.jsx)(j,{Companies:B,Locations:J,Quotations:E,ShowQuotationModal:l,SubmitConfirmation:O,Requests:V,history:e,RequestDetails:ee,Specifications:H,AttachedQuotations:N,addRow:_,openRequestDetails:function(e){return function(e,t,n,o){u.a.post("/purchase/requisition/details",{pr_id:e}).then((function(e){t(e.data[1][0]),n(e.data[2]),o(e.data[3])})).catch((function(e){console.log(e)}))}(e,te,M,D)},PRSubmittion:function(t){return function(e,t,n,o,i){e.preventDefault();for(var a=new FormData,c=document.getElementById("specifications_table_body").childNodes,l=Object.keys(c).map((function(e){return[c[e]]})),f=[],h=!0,b=function(e){var t=!0,o={},i=l[e][0].childNodes,a=Object.keys(i).map((function(e){return[i[e]]}));""===l[e][0].childNodes[1].textContent&&""===l[e][0].childNodes[2].textContent&&""===l[e][0].childNodes[3].textContent||""===l[e][0].childNodes[0].textContent&&(h=!1,n.dark("There is an incomplete value in the specifications list.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}));for(var c=0;c<a.length;c++){var u=a[c][0].id.split("_");u.pop(),o=Object(r.a)(Object(r.a)({},o),{},Object(s.a)({},u.join("_"),a[c][0].textContent))}for(var d=Object.keys(o).map((function(e){return[o[e]]})),p=0;p<d.length;p++)""===d[p][0]&&(t=!1);t&&f.push(o)},g=0;g<l.length;g++)b(g);h&&(p()("fieldset").prop("disabled",!0),a.append("specifications",JSON.stringify(f)),a.append("data",JSON.stringify(i)),a.append("note",e.target.notes.value),a.append("requested_by",sessionStorage.getItem("EmpID")),o.forEach((function(e){a.append("Attachments",e.file)})),u.a.post("/purchase/requisition/submittion&&submit_by=employee",a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){"success"===e.data&&(d.a.emit("new_purchase_requisition_found"),setTimeout((function(){p()("fieldset").prop("disabled",!1),t.replace("/purchase/requisition/requests")}),2e3),n.dark("Purchase Requisition Has Been Generated",{position:"top-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)})))}(t,e,c.b,E,U)},SubmitPR:function(e){return function(e,t,n){e.preventDefault(),t({company_code:e.target.company_code.value,location_code:e.target.location_code.value,new_purchase_checkbox:e.target.new_purchase.checked,repair_checkbox:e.target.repair.checked,replace_recycle_checkbox:e.target.replace_recycle.checked,budgeted_checkbox:e.target.budgeted.checked,not_budgeted_checkbox:e.target.not_budgeted.checked,invoice_attached_checkbox:e.target.invoice_attached.checked,reason:e.target.reason.value,total_calculated_amount:g()}),n(!0)}(e,W,x)},setSubmitConfirmation:x,onAttachQuotations:function(e){return function(e,t){var n=new FileReader;n.onload=function(){if(2===n.readyState){for(var o=[],i=0;i<e.target.files.length;i++)o.push({file:e.target.files[i],name:e.target.files[i].name,extension:e.target.files[i].type});t(o)}},e.target.files[0]&&n.readAsDataURL(e.target.files[0])}(e,I)},setShowQuotationModal:b,onContentEdit:h,onContentInput:f,loadRequests:function(){return function(e){u.a.post("/purchase/requisition/load/requests",{emp_id:sessionStorage.getItem("EmpID")}).then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}(X)},CancelRequisition:function(t,n){return function(e,t,n){e.preventDefault();var o=e.target.reason.value;p()("fieldset").prop("disabled",!0),u.a.post("/purchase/requisition/cancellation",{emp_id:sessionStorage.getItem("EmpID"),reason:o,pr_id:t}).then((function(e){"success"===e.data&&(setTimeout((function(){n.push("/purchase/requisition/requests")}),1500),p()("#error_alert_cancelation").removeClass("d-none").text("Your application has been canceled."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,e)},ApproveRequisition:function(t,n,o,i){return function(e,t,n,o,i){e.preventDefault();var a=e.target.reason.value;p()("fieldset").prop("disabled",!0),u.a.post("/purchase/requisition/approval",{emp_id:sessionStorage.getItem("EmpID"),reason:a,pr_id:t,requested_by:n,submitted_to:o}).then((function(e){"success"===e.data&&(setTimeout((function(){i.push("/purchase/requisition/requests")}),1500),p()("#error_alert_approval").removeClass("d-none").text("The application has been approved."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,o,i,e)},RejectRequisition:function(t,n,o,i){return function(e,t,n,o,i){e.preventDefault();var a=e.target.reason.value;p()("fieldset").prop("disabled",!0),u.a.post("/purchase/requisition/reject",{emp_id:sessionStorage.getItem("EmpID"),remarks:a,pr_id:t,requested_by:n,specifications:JSON.stringify(o),department:"accounts"}).then((function(e){"success"===e.data&&(setTimeout((function(){i.push("/purchase/requisition/requests")}),1500),p()("#error_alert_rejection").removeClass("d-none").text("The application has been rejected."))})).catch((function(e){p()("fieldset").prop("disabled",!1),console.log(e)}))}(t,n,o,i,e)}})}),Object(v.jsx)(c.a,{})]})}}}]);